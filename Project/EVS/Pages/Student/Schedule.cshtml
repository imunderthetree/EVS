@page
@model EVS.Pages.Student.ScheduleModel
@{
    ViewData["Title"] = "Schedule";
}
@section Sidebar {
    @await Html.PartialAsync("_StudentSidebar")
}
<h2>My Schedule</h2>
<div style="margin-bottom:18px;">
    <form method="get" style="display:inline-block;">
        <label>View:
            <select name="Range" asp-for="Range">
                <option value="day" selected="@(Model.Range=="day" ? "selected" : null)">Day</option>
                <option value="week" selected="@(Model.Range=="week" ? "selected" : null)">Week</option>
            </select>
        </label>
        <input type="date" name="Date" asp-for="Date" value="@Model.Date" />
        <button type="submit" class="btn btn-primary btn-sm">Go</button>
    </form>
    <a asp-page-handler="Csv" asp-route-range="@Model.Range" asp-route-date="@Model.Date" class="btn btn-outline-primary btn-sm">Export CSV</a>
    <a asp-page-handler="Ical" asp-route-range="@Model.Range" asp-route-date="@Model.Date" class="btn btn-outline-secondary btn-sm">Sync (ICS)</a>
</div>
@if (Model.Sessions != null && Model.Sessions.Count > 0)
{
    <table class="table table-bordered">
        <thead>
            <tr>
                <th>Subject</th>
                <th>Teacher</th>
                <th>Start</th>
                <th>End</th>
                <th>Location</th>
                <th>Notes</th>
            </tr>
        </thead>
        <tbody>
        @foreach (var s in Model.Sessions)
        {
            <tr>
                <td>@s.Subject</td>
                <td>@s.TeacherName</td>
                <td>@s.StartTime.ToString("g")</td>
                <td>@s.EndTime.ToString("g")</td>
                <td>@s.Location</td>
                <td>@s.Notes</td>
            </tr>
        }
        </tbody>
    </table>
}
else
{
    <div>No schedule found for the selected period.</div>
}

